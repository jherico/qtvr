{"Shader":{"ver":"0.1","info":{"id":"Xls3z2","date":"1423432680","viewed":932,"name":"Another Kaliset Mod","username":"eiffie","description":"Inspired by <a href=\"https:\/\/www.shadertoy.com\/view\/XtlGDH\" class=\"regular\" target=\"_blank\">https:\/\/www.shadertoy.com\/view\/XtlGDH<\/a>","likes":14,"published":3,"flags":0,"tags":["kaliset"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"\/\/Another Kaliset Mod (inspired by https:\/\/www.shadertoy.com\/view\/XtlGDH from bergi)\n#define time iGlobalTime\n#define size iResolution\n\nvec3 mcol,ro;\nfloat dL=100.0,mxscl=max(0.5,abs(sin(time*0.1))*2.5),ltpos=-1.5+sin(time*10.0);\nfloat DE(vec3 z0)\n{\n\tvec4 z = vec4(z0,1.0);\n\tfloat d=100.0;\n\tfor (int n = 0; n < 7; n++) {\/\/kaliset mod\n\t\tz.xyz=abs(z.yzx+vec3(-0.25,-0.75,-1.5)+ro*0.1);\n\t\tz\/=min(dot(z.xyz,z.xyz),mxscl);\n\t\td=min(d,(length(z.xy)+abs(z.z)*0.01)\/z.w);\n\t\tif(n==2)dL=min(dL,(length(z.xy)+abs(z.z+ltpos)*0.1)\/z.w);\n\t\tif(n==3)mcol=vec3(0.7,0.6,0.5)+sin(z.xyz)*0.1;\n\t}\n\treturn d;\n}\n\n\n\nfloat rndStart(vec2 co){return 0.1+0.9*fract(sin(dot(co,vec2(123.42,117.853)))*412.453);}\n\nmat3 lookat(vec3 fw,vec3 up){\n\tfw=normalize(fw);vec3 rt=normalize(cross(fw,up));return mat3(rt,cross(rt,fw),fw);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n\tfloat pxl=2.0\/size.y;\/\/find the pixel size\n\tfloat tim=time*0.3;\n\t\n\t\/\/position camera\n\tro=vec3(cos(tim*1.1),-1.11,sin(tim*0.7))*(2.0+0.7*cos(tim*1.3))+vec3(1.0);\n\tvec3 rd=normalize(vec3((2.0*fragCoord.xy-size.xy)\/size.y,2.0));\n\trd=lookat(vec3(1.0,0.0,0.0)-ro,vec3(0.0,1.0,0.0))*rd;\n\t\/\/ro=eye;rd=normalize(dir);\n\tvec3 LDir=normalize(vec3(0.4,0.75,0.4));\/\/direction to light\n\tvec3 bcol=vec3(0.0);\n\t\/\/march\n\t\n\t\n\tfloat t=DE(ro)*rndStart(fragCoord.xy),d,od=1.0;\n\tvec4 col=vec4(0.0);\/\/color accumulator\n\tfor(int i=0;i<99;i++){\n\t\td=DE(ro+rd*t);\n\t\tfloat px=pxl*(1.0+t);\n\t\tif(d<px){\n\t\t\tvec3 scol=mcol;\n\t\t\tfloat d2=DE(ro+rd*t+LDir*px);\n\t\t\tfloat shad=abs(d2\/d),shad2=max(0.0,1.0-d\/od);\n\t\t\tscol=scol*shad+vec3(0.2,0.0,-0.2)*(shad-0.5)+vec3(0.1,0.15,0.2)*shad2;\n\t\t\tscol*=3.0*max(0.2,shad2);\n\t\t\tscol\/=(1.0+t)*(0.2+10.0*dL*dL);\n\t\t\t\n\t\t\tfloat alpha=(1.0-col.w)*clamp(1.0-d\/(px),0.0,1.0);\n\t\t\tcol+=vec4(clamp(scol,0.0,1.0),1.0)*alpha;\n\t\t\tif(col.w>0.9)break;\n\t\t}\n\t\tcol.rgb+=vec3(0.01,0.02,0.03)\/(1.0+1000.0*dL*dL)*(1.0-col.w);\n\t\tod=d;\n\t\tt+=d*0.5;\n\t\tif(t>20.0)break;\n\t}\n\tcol.rgb+=bcol*(1.0-clamp(col.w,0.0,1.0));\n\n\tfragColor=vec4(col.rgb,1.0);\n} ","name":"","description":"","type":"image"}]}}