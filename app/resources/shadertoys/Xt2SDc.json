{"Shader":{"ver":"0.1","info":{"id":"Xt2SDc","date":"1446984670","viewed":499,"name":"Everything Glowing II","username":"834144373","description":"the tutorial for young coder and students to easy undersand.<br\/>here you see a good effect : http:\/\/www.glslsandbox.com\/e#28742.0<br\/>move the mouse to change the color","likes":9,"published":3,"flags":0,"tags":["3d","raymarching","distancefield","glowing","density"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"\/\/Everythng Glowing.glsl\n\/\/License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n\/\/Created by 834144373  2015\/11\/8\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\nvec3 roty(vec3 p,float angle){\n  float s = sin(angle),c = cos(angle);\n    mat3 rot = mat3(\n      c, 0.,-s,\n        0.,1., 0.,\n        s, 0., c\n    );\n    return p*rot; \n}\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n\/\/raymaching step I for normal obj\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\nfloat obj(vec3 pos){\n    pos -= vec3(0.,-.6,0.);\n    \/\/here you can see \"inigo quilez's particles about the distance field function\" who's id named \"iq\"....\n    float res =  length(max(abs(pos)-vec3(0.8,0.2,0.35),0.0))-0.1;\n\tres = min(res,length(abs(pos-vec3(0.,0.7,0.))-vec3(0.7,0.4,0.4))-.3);\n    return res;\n}\n\n\/\/raymarching step I\n\/\/find object\nfloat disobj(vec3 pointpos,vec3 dir){\n    float dd = 1.;\n    float d = 0.;\n    for(int i = 0;i<45;++i){\n      vec3 sphere = pointpos + dd*dir;\n          d = obj(sphere);\n      dd += d;\n\tif(d<0.02)break;\n    }\n    return dd;\n}\n\n\/\/\/\/\/\/raymarching step II for detail obj\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n\/\/Inspired form guil https:\/\/www.shadertoy.com\/view\/MtX3Ws\n\/\/and I changed something\nfloat objdetal(in vec3 p) {\n  \tfloat res = 0.;\n    vec3 c = p;\n  \tfor (int i = 0; i < 10; ++i) {\n        p =1.7*abs(p)\/dot(p,p) -0.8;\n        p=p.zxy;\n        res += exp(-20. * abs(dot(p,c)));        \n  }\n  return res\/2.;\n}\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n\/\/raymarching step II \n\/\/raymarching  inside of the objects\n\/\/and sample the \"density\"=\"min distance\" with the raymarching\nvec4 objdensity(vec3 pointpos,vec3 dir,float finaldis){\n  vec4 color=vec4(0.);\n    float den = 0.;\n    vec3 sphere = pointpos + finaldis*dir;\n    float dd = 0.;\n    for(int j = 0;j<45;++j){\n        vec4 col;\n        col.a = objdetal(sphere);\n        float c = col.a\/200.;\n        col.rgb = vec3(c,c,c*c);\n        col.rgb *= col.a;\n        col.rgb *= float(j)\/20.;\n        dd = 0.01*exp(-2.*col.a);\n        sphere += dd*dir;\n        color += col*0.8;\n        if(color.a\/200.>.9 || dd>200.)break;\n    }\n    return color*4.5;\n}\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n#define time iGlobalTime*0.3\nvoid mainImage(out vec4 color,in vec2 PixelUV)\n{\n    vec2 uv = (PixelUV.xy \/ iResolution.xy-0.5)*2.;\n         uv.x *= iResolution.x\/iResolution.y;\n    vec2 Mo = iMouse.xy\/iResolution.xy;\n\t\t Mo = (vec2(1.-Mo.x,Mo.y)-0.5)*2.2;\n    \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n    vec3 dir = normalize(vec3(uv,2.));\n         dir = roty(dir,time);\n    \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n    vec3 campos = vec3(0.,0.,-2.8);\n         campos = roty(campos,time);\n    \/\/raymarching step I\n    float finaldis = disobj(campos,dir);\n    vec4 col = vec4(0.061,0.06,0.061,1.);\n    if(finaldis < 20.){\n        \/\/raymarching step II\n        \/\/raymarching in raymarching, no raymarching and raymarching\n        col = objdensity(campos,dir,finaldis);\n        col += 0.6*col*vec4(0.7+Mo.x,0.8+Mo.y,0.5,1.);\n    }\n    color = vec4(col.rgb,1.0);\n}","name":"","description":"","type":"image"}]}}