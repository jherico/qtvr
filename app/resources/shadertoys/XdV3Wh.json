{"Shader":{"ver":"0.1","info":{"id":"XdV3Wh","date":"1454259096","viewed":21,"name":"RainShaderTest","username":"yasuo","description":"It's just rain experiment.","likes":0,"published":3,"flags":0,"tags":["2d"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"const float PI = 3.14159265359;\nconst float DEG_TO_RAD = PI \/ 180.0;\n\n\/\/ from iq\nfloat sdSegment( in vec2 p, in vec2 a, in vec2 b )\n{\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp( dot(pa,ba)\/dot(ba,ba), 0.0, 1.0 );\n    return length( pa - ba*h );\n}\n\nvec2 rot(vec2 p, float a) {\n    return vec2(\n        cos(a) * p.x - sin(a) * p.y,\n        sin(a) * p.x + cos(a) * p.y);\n}\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy \/ iResolution.xy;\n    \n    vec3 cl = vec3(0.0);\n\tfloat time = iGlobalTime;\n\tint numrain = 10;\n    float speed = 0.1;\n    if(mod(time,10.0) >= 2.0 && mod(time,10.0) < 5.0) {\n        numrain = 20;\n        speed = 0.2;\n    } else if(mod(time,10.0) >= 5.0 && mod(time,10.0) < 8.0) {\n        numrain = 30;\n        speed = 0.25;\n    } else if(mod(time,10.0) >= 8.0 && mod(time,10.0) <= 10.0) {\n        numrain = 40;\n        speed = 0.4;\n    }\n\n    float l;\n    for(int i = 0; i<40; i++) {\n        if(i<numrain){\n            float dir = 1.0;\n            if (mod(float(i),2.0) == 1.0){\n                dir = -1.0;\n            }\n\n            float temp = rand(vec2(1.02,1.0+float(i)));\n            float temp2 = rand(vec2(1.02+float(i),1.01+float(i)*dir));\n\n            vec2 p0 = rot(vec2(-0.1+temp,0.1+temp2-tan(time*float(i)*speed)),DEG_TO_RAD*-15.0);\n            vec2 p1 = rot(vec2(-0.1+temp,0.4+temp2-tan(time*float(i)*speed)),DEG_TO_RAD*-15.0);\n\n            l = sdSegment(uv, p0, p1);\n            cl = mix( cl, vec3(1.0), 1.0-smoothstep( 0.001, 0.003, l ) );\n        }\n    }\n\n\n    fragColor = vec4( vec3( cl ), 1.0 );\n}","name":"","description":"","type":"image"}]}}