{"Shader":{"ver":"0.1","info":{"id":"lt2SzG","date":"1444708655","viewed":573,"name":"Hexlicity","username":"klk","description":"Maze on hexagonal grid. With direction on walls.","likes":13,"published":3,"flags":0,"tags":["mazehexagon"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"#define pi 3.14159265359\n\n#define float3 vec3\n#define float2 vec2\n#define float4 vec4\n\n\nfloat vlx(float2 uv, out float a)\n{\n    float v=0.0;\n    float2 lp=uv-float2(-0.5,0.5*tan(pi\/6.0));\n    v=length(lp);a=atan(lp.y, lp.x);\n\n    float2 lp1=uv-float2(0.5,0.5*tan(pi\/6.0));\n    float v1=length(lp1);\n    if(v1<v){v=v1;a=atan(lp1.y, lp1.x);}\n\n    float2 lp2=uv-float2( 0.0,-0.5\/cos(pi\/6.0));\n    float v2=length(lp2);\n    if(v2<v){v=v2;a=atan(lp2.y, lp2.x);}\n    \n    a=(a\/pi*0.5+0.5);\n    \n    return v;\n}\n\nfloat4 hex(float2 uv, out float ang1, out float ang2)\n{\n    float x=uv.x;\n    float y=uv.y;\n    float h=1.0\/cos(pi\/6.0);\n    \n\tx+=(fract(y*h\/2.0)>0.5?0.0:0.5);\n    x=fract(x)-0.5;\n    y=fract(y*h)\/h-0.5\/h;\n    float n=6.0;\n    float a=atan(x,y)\/pi\/2.0;\n    float v=length(float2(x,y));\n    float2 p=float2(0,0);\n    float2 p0=float2(sin(pi\/6.0),cos(pi\/6.0));\n    if(y<0.0)p0.y=-p0.y;\n    if(x<0.0)p0.x=-p0.x;\n\tfloat v0=length(float2(x,y)-p0);\n    if(v0<v)\n    {\n        v=v0;p=p0;\n\t    x=x-p.x;\n\t    y=y-p.y;\n    }\n\n    a=atan(x,y);\n    v=length(float2(x,y))*2.0;\n    v=(v*5.0+a*pi\/32.0)*10.0;\n\tfloat v1=0.0;\n    float v2=0.0;\n\n    v1=vlx(float2(x,y), ang1);\n    v2=vlx(float2(x,-y), ang2);\n    return float4(x,y,v1,v2);\n}\n\nvoid mainImage( out float4 fragColor, in float2 fragCoord )\n{\n\tfloat2 uv = fragCoord.xy \/100.0;\n    float a1=0.0;\n    float a2=0.0;\n    float4 h=hex(uv, a1, a2);\n    float v=h.z;\n    float2 ixy=uv-h.xy;\n    float a=a1;\n    v=h.z; \n    if(fract(ixy.x*0.31+sin(ixy.y*0.073+ixy.x*0.0013))>0.5)\n    {\n        v=h.w;\n        a=a2;\n    }\n    float v0=abs(v-0.5*tan(pi\/6.0));\n    float a0=a;\n    a=cos((a*6.0-v0*v0*30.0+iGlobalTime*2.0)*pi)*0.5+0.5;\n\tv0=abs(v-0.5*tan(pi\/6.0));\n    v=clamp(v0*100.0-10.0,0.0,1.0);\n    \n    float3 col=mix(float3(0.0,0.3+0.3*sin(uv.x*0.71),1.0),float3(1,0.3+0.3*sin(uv.y*0.93),0.1),a);\n    float3 bak=float3(sin(ixy.x*0.315)*0.5+0.5,sin(ixy.y*0.635)*0.5+0.5,.8);\n    \n    float sh=clamp(v0*8.0-0.5,0.0,1.0);\n    bak=mix(float3(1,1,2),bak,sh);\n\tfragColor = float4(mix(col*(1.0-v0*v0*60.0),bak,v),1.0);\n\/\/    fragColor = float4(bak,1.0);\n}","name":"","description":"","type":"image"}]}}