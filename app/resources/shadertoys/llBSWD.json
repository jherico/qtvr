{"Shader":{"ver":"0.1","info":{"id":"llBSWD","date":"1443630570","viewed":765,"name":"Simple metaballs(2D)","username":"mlavik1","description":"Simple metaballs in 2D.","likes":5,"published":3,"flags":0,"tags":["metaballs","blobbyobjects"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"uniform float time;\nuniform vec2 mouse;\nuniform vec2 resolution;\n\n\/\/ influence threshold\nconst float threshold = 0.95;\n\n\nstruct Metaball\n{\n\tvec3 colour;\n\tvec2 position;\n\tfloat radius;\n};\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tMetaball metaballs[4];\n\t\/\/ add metaballs (colour, position, radius)\n\tmetaballs[0] = Metaball(vec3(1,0,0), vec2(100.0,90.0), 60.0);\n\tmetaballs[1] = Metaball(vec3(0,1,0), vec2(120.0,200.0), 50.0);\n\tmetaballs[2] = Metaball(vec3(0,0,1), vec2(200.0,90.0), 45.0);\n\tmetaballs[3] = Metaball(vec3(1,0,0), vec2(400.0,190.0), 45.0);\n\t\/\/ animate(rotate) some of the metaballs\n\tmetaballs[0].position.x = iResolution.x*sin(iGlobalTime*1.2314)\/2.0  + iResolution.x\/2.0;\n\tmetaballs[0].position.y = iResolution.y*cos(iGlobalTime*1.2314)\/2.0  + iResolution.y\/2.0;\t\n\tmetaballs[1].position.x = iResolution.x*sin(iGlobalTime*1.2314)\/2.0  + iResolution.x\/2.0;\n    \t\n\t\n\tvec3 col = vec3(0,0,0); \/\/ colour = sum(metaball.colour * influence)\n\tfloat infl = 0.0;\t\/\/ total influence\n\tfor(int i = 0; i < 4; i++)\n\t{\n\t\tMetaball mb = metaballs[i];\n        \/\/ distance from pixel to metaball centre\n\t\tfloat dist = length(fragCoord.xy - mb.position);\n        \/\/ influence from current metaball\n\t\tfloat currInfl = mb.radius * mb.radius;\n\t\tcurrInfl \/= (pow(abs(fragCoord.x-mb.position.x),2.0) + pow(abs(fragCoord.y-mb.position.y),2.0));\n\t\tinfl += currInfl;\n\t\tcol += mb.colour*currInfl;\n\t}\n\t\/\/ normalise, if influence > threshold\n\tif(infl > threshold)\n\t\tcol = normalize(col);\n\t\/\/ show outer line\n    col = mix(col, vec3(1.0), smoothstep(threshold+0.05, threshold, infl) * smoothstep(threshold-0.05, threshold, infl));\n\t\t\n\tfragColor.xyz = col;\n\n}","name":"","description":"","type":"image"}]}}