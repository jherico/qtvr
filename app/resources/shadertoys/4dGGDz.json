{"Shader":{"ver":"0.1","info":{"id":"4dGGDz","date":"1453998790","viewed":66,"name":"demo1","username":"esperanc","description":"texture test","likes":0,"published":3,"flags":0,"tags":["texturecompositing"],"hasliked":0},"renderpass":[{"inputs":[{"id":1,"src":"\/presets\/tex00.jpg","ctype":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"}},{"id":9,"src":"\/presets\/tex08.jpg","ctype":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"}}],"outputs":[{"channel":"0"}],"code":"\/\/\n\/\/ Color of the stripes\nvec4 stripeColor = vec4(1.0, 0.0, 0.0, 1.0);\n\n\/\/ \n\/\/ Color of the background\nvec4 bgColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n\n\/\/ Stripe thickness\nfloat thick = 5.0;\n\n\/\/ Luminosity of a color\nfloat lum(in vec4 color) {\n\treturn 0.299 * color.r + 0.587*color.g + 0.114 * color.b;\n}\n\n\n\/\/ Modulates the value of a pixel at pos as stripes with varying thickness\nvec4 stripeModulate(in vec2 pos, in float value, in vec4 stripeColor) {\n\n    \/\/ Reference line \n    float angle = 3.14159265359\/4.0;\n    vec3 line = vec3 (cos(angle),sin(angle), 0.0);\n    \n    \/\/ Distance to line\n    float d = abs(dot (vec3(pos,1),line));\n    \n    \/\/ Modulus thickness\n    float v = mod(d,thick);\n    \n    \/\/ Reference value\n    float ref = thick*value;\n    \n    if (v >= ref+0.5) {\n        if (v <= thick-0.5) return bgColor;\n        return bgColor*(thick+0.5-v)+stripeColor*(v-thick+0.5);\n    }\n    if (v <= ref-0.5) {\n        if (v >= 0.5) return stripeColor;\n        return stripeColor*(v+0.5)+bgColor*(0.5-v);\n    }\n    return stripeColor*(ref+0.5-v)+bgColor*(v-ref+0.5);\n    \n}\n\n\/*\n\/\/ Modulates the value of a pixel at pos as stripes with varying angles\nvec4 stripeModulate(in vec2 pos, in float value, in vec4 stripeColor) {\n\n    \/\/ Reference line \n    float angle = 3.14159265359\/2.0*value;\n    vec3 line = vec3 (cos(angle),sin(angle), 0.0);\n    \n    \/\/ Distance to line\n    float d = abs(dot (vec3(pos,1),line));\n    \n    \/\/ Modulus thickness\n    float v = mod(d,thick);\n    \n    \/\/ Reference value\n    float ref = thick\/2.0;\n    \n    if (v >= ref+0.5) {\n        if (v <= thick-0.5) return bgColor;\n        return bgColor*(thick+0.5-v)+stripeColor*(v-thick+0.5);\n    }\n    if (v <= ref-0.5) {\n        if (v >= 0.5) return stripeColor;\n        return stripeColor*(v+0.5)+bgColor*(0.5-v);\n    }\n    return stripeColor*(ref+0.5-v)+bgColor*(v-ref+0.5);\n    \n}\n*\/\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy \/ iResolution.xy;\n    float gray = lum(texture2D(iChannel0, uv));\n    vec4 color = texture2D(iChannel1, uv);\n    if (iMouse.z>0.0) fragColor = vec4(gray,gray,gray,1.0);\n\telse fragColor = stripeModulate(fragCoord, gray, color);\n}\n","name":"","description":"","type":"image"}]}}