{"Shader":{"ver":"0.1","info":{"id":"ltXGRj","date":"1423242433","viewed":790,"name":"Questionable Kiwi","username":"eiffie","description":"It doesn't have an expiration date but I'm still hesitant.","likes":8,"published":3,"flags":0,"tags":["fur","defur","kiwi"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"\/\/Questionable Kiwi by eiffie\n\n\/\/Another DE Fur example but had trouble coming up with a good hair placement.\n\/\/I think this DE is suffering from discontinuity and hairy ball syndrome (don't search that!)\n\n#define time iGlobalTime\n#define size iResolution\nvec3 mcol,LDir;\nfloat DE(in vec3 p){\/\/fur ball\n\tp+=sin(p.yzx*(20.0+5.0*sin(time*0.1))+time*2.0)*0.02;\n\tfloat r=length(p);\n\tif(r<1.0){\n\t\tvec3 p2=p*p;\n\t\tmcol=vec3((r-0.5)*(1.0+0.5*dot(LDir,p)));\n\t\tvec2 v=(p2.x>p2.y && p2.x>p2.z)?p.yz\/p.x:(p2.y>p2.z)?p.zx\/p.y:p.xy\/p.z;\n\t\tfloat m=0.03;\/\/-0.04*dot(p2,p2);\n\t\tv=mod(v+m,2.0*m)-m;\n\t\tfloat r2=(length(v)-0.03+0.04*r);\n\t\tr-=0.8;\n\t\tif(r2<r)r=r2;else mcol.g*=1.25;\n\t}else r-=0.9;\n\treturn r;\n}\n\n\nfloat rndStart(vec2 co){return 0.1+0.9*fract(sin(dot(co,vec2(123.42,117.853)))*412.453);}\n\nmat3 lookat(vec3 fw,vec3 up){\n\tfw=normalize(fw);vec3 rt=normalize(cross(fw,up));return mat3(rt,cross(rt,fw),fw);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n\tfloat px=4.0\/size.y;\/\/find the pixel size\n\tfloat tim=time*0.3;\n\t\n\t\/\/position camera\n\tvec3 ro=vec3(cos(tim),sin(tim*0.7)*0.3,sin(tim))*(2.0+0.7*cos(tim));\n\tvec3 rd=normalize(vec3((2.0*fragCoord.xy-size.xy)\/size.y,2.0));\n\trd=lookat(vec3(0.0,(2.7-length(ro))*0.3,0.0)-ro,vec3(0.0,1.0,0.0))*rd;\n\t\/\/ro=eye;rd=normalize(dir);\n\tLDir=normalize(vec3(0.4,0.75,0.4));\/\/direction to light\n\tvec3 bcol=clamp(vec3(1.0-rd.y,1.0-rd.y-0.1*exp(-abs(rd.y*15.0)),1.0-0.5*exp(-abs(rd.y*5.0))),0.0,1.0);\/\/backcolor\n\t\/\/march\n\t\n\tfloat tG=(-0.85-ro.y)\/rd.y,d,step=0.0;\n\tif(tG<0.0)tG=1000.0;\n\tfloat MAX_T=min(tG,6.0);\n\tvec2 g=ro.xz+rd.xz*tG;\n\tfloat t=DE(ro)*rndStart(fragCoord.xy);\n\tvec4 col=vec4(0.0);\/\/color accumulator\n\tfor(int i=0;i<99;i++){\n\t\td=DE(ro+rd*t);\n\t\tif(d<px){\n\t\t\tvec3 scol=mcol;\n\t\t\tfloat d2=DE(ro+rd*t+LDir*px);\n\t\t\tfloat shad=0.5*abs(d2\/d);\n\t\t\tscol=scol*shad+vec3(0.2,0.0,-0.2)*(shad-0.5);\n\t\t\tfloat alpha=(1.0-col.w)*clamp(1.0-d\/(px),0.0,1.0);\n\t\t\tcol+=vec4(clamp(scol,0.0,1.0),1.0)*alpha;\n\t\t\tif(col.w>0.9)break;\n\t\t}\n\t\tt+=d*0.6;\n\t\tif(t>MAX_T)break;\n\t}\n\n\t\/\/color the ground \n\tif(rd.y<0.0){\n\t\tro+=rd*tG;\n\t\tfloat s=1.0,dst=0.1;\n\t\tt=DE(ro)*rndStart(fragCoord.xy);\n\t\tfor(int i=0;i<8;i++){\n\t\t\tfloat d=max(0.0,DE(ro+LDir*t)*1.5)+0.05;\n\t\t\ts=min(s,8.0*d\/t);\n\t\t\tt+=dst;dst*=2.0;\n\t\t}\n\t\tbcol*=0.5+0.5*s;\n\t}\n\tcol.rgb+=bcol*(1.0-clamp(col.w,0.0,1.0));\n\n\tfragColor=vec4(col.rgb,1.0);\n} ","name":"","description":"","type":"image"}]}}