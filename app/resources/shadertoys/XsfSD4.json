{"Shader":{"ver":"0.1","info":{"id":"XsfSD4","date":"1400736706","viewed":1153,"name":"Warping - procedural 3","username":"iq","description":"In place warping","likes":12,"published":3,"flags":0,"tags":["procedural","2d","warping"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"\/\/ Created by inigo quilez - iq\/2014\n\/\/ License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n\nvec2 hash( vec2 p )\n{\n    p = vec2( dot(p,vec2(2127.1,81.17)), dot(p,vec2(1269.5,283.37)) );\n\treturn fract(sin(p)*43758.5453);\n}\n\nfloat noise( in vec2 p )\n{\n    vec2 i = floor( p );\n    vec2 f = fract( p );\n\t\n\tvec2 u = f*f*(3.0-2.0*f);\n\n    float n = mix( mix( dot( -1.0+2.0*hash( i + vec2(0.0,0.0) ), f - vec2(0.0,0.0) ), \n                        dot( -1.0+2.0*hash( i + vec2(1.0,0.0) ), f - vec2(1.0,0.0) ), u.x),\n                   mix( dot( -1.0+2.0*hash( i + vec2(0.0,1.0) ), f - vec2(0.0,1.0) ), \n                        dot( -1.0+2.0*hash( i + vec2(1.0,1.0) ), f - vec2(1.0,1.0) ), u.x), u.y);\n\treturn 0.5 + 0.5*n;\n}\n\nfloat fbm( in vec2 x )\n{\n\tfloat m = 0.0;\n\tvec2 p = 6.0*x;\n\n\tfloat w = 0.5;\n\tfloat s = 1.0;\n\tfor( int i=0; i<8; i++ )\n    {\n\t\tfloat n = noise( p*s );\n\t\tm += w*n;\n\n        p.y -= 1.25*(-1.0+2.0*n) - 0.1*iGlobalTime*w; \/\/ warp\n\t\t\n\t\tw *= 0.5;\n\t\ts *= 2.0;\n\n\t}\n\t\n    return m;\t\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p = fragCoord.xy\/iResolution.x;\n\n    \/\/ pattern\t\n\tfloat n = fbm( p );\n\n    \/\/ normal\t\n\tvec2 e = vec2(0.03,0.0);\n\tvec3 nor = normalize( vec3( fbm(p-e.xy)-fbm(p+e.xy), 2.0*e.x, fbm(p-e.yx)-fbm(p+e.yx) ) );\n\n    \/\/ color\n\tfloat c = pow(n,4.0)*6.0;\t\t\n\tvec3 col = 0.5 + 0.5*cos( 5.0 + n*12.0 + vec3(0.8,0.4,0.0) );\n    col *= 0.4 + 0.6*c;\n\t\n    \/\/ light\t\n\tvec3 lig = normalize( vec3(1.0,0.2,1.0) );\n\tcol *= vec3(0.6,0.7,0.8) + 1.0*vec3(1.0,0.7,0.5)*clamp( 0.3 + 0.7*dot(nor,lig), 0.0, 1.0 );\n    col += 1.5*vec3(1.0,0.5,0.0)*pow(1.0-nor.y,2.0)*c;\t\n\n    \/\/ postpro\n\tcol = sqrt(col)-0.15;\n    col *= sqrt(1.0-0.5*abs(p.x-0.5));\t\n\t\n    fragColor = vec4( col, 1.0 );\n}","name":"","description":"","type":"image"}]}}