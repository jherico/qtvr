{"Shader":{"ver":"0.1","info":{"id":"Xdf3z4","date":"1363260944","viewed":1705,"name":"3D Spheres !","username":"Eybor","description":"A fractal composed of spheres with an Anaglyph effect.","likes":18,"published":3,"flags":0,"tags":["3d","raymarching","distancefields","spheres","anaglyph"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"\/\/Anaglyph effect !\n\n\/\/Uncoment if you have red glass in your left eye and cyan in your right :p\n\/\/#define INVERT_CHANNELS\n\nfloat scene(vec3 p)\n{\n\treturn max(-(length(mod(p,vec3(40.))-.5*vec3(40.))-24.),max(-(length(mod(p,vec3(10.))-.5*vec3(10.))-6.),max(-(length(mod(p,vec3(2.5))-.5*vec3(2.5))-1.5),-(length(mod(p,vec3(.625))-.5*vec3(.625))-.375))));\n}\n\nvec3 gn(vec3 p)\n{\n\tvec3 eps = vec3(0.02,0.0,0.0);\n\treturn normalize(vec3(\n\t\tscene(p+eps.xyy)-scene(p-eps.xyy),\n\t\tscene(p+eps.yxy)-scene(p-eps.yxy),\n\t\tscene(p+eps.yyx)-scene(p-eps.yyx)\n\t));\n}\n\nfloat ao(vec3 p, vec3 n, vec2 a)\/\/Thx to XT95\n{\n\tfloat dlt = a.x;\n\tfloat oc = 0.0, d = a.y;\n\tfor(int i = 0; i<6; i++)\n\t{\n\t\toc += (float(i) * a.x - scene(p + n * float(i) * a.x)) \/ d;\n\t\td *= 2.0;\n\t}\n\treturn clamp(1.0 - oc, 0.0, 1.0);\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n\tvec3 o = vec3 (.3, 5.25, 16.-iGlobalTime);\n\tvec3 rd = normalize(vec3((-1.+2.*fragCoord.xy\/iResolution.xy)*vec2(iResolution.x\/iResolution.y, 1.), -1.));\n\t\n\t#ifdef INVERT_CHANNELS\n\tfloat d = -.05;\n\t#else\n\tfloat d = .05;\n\t#endif\n\tvec3 pr = o + vec3(d, 0., 0.);\n\tvec3 pc = o - vec3(d, 0., 0.);\n\tfloat d1, d2;\n\tfor(int i = 0; i < 64; i++)\n\t{\n\t\td1 = scene(pr);\n\t\tpr += d1*rd;\n\t\td2 = scene(pc);\n\t\tpc += d2*rd;\n\t\tif(max(d1, d2) < .001)\n\t\t\tbreak;\n\t}\n\tvec3 nr = gn(pr);\n\tvec3 nc = gn(pc);\n\t\n\tvec3 co;\n\tco.r = (1.-distance(pr, o)*.01)*ao(pr,nr,vec2(.5,2.))*ao(pr,nr,vec2(1.,4.));\n\tco.g = (1.-distance(pc, o)*.01)*ao(pc,nc,vec2(.5,2.))*ao(pc,nc,vec2(1.,4.));\n\tco.b = (1.-distance(pc, o)*.01)*ao(pc,nc,vec2(.5,2.))*ao(pc,nc,vec2(1.,4.));\n\t\n\tco = clamp(co ,0. , 1.);\n\t\n\tfragColor = vec4(co, 1.0);\n}","name":"","description":"","type":"image"}]}}