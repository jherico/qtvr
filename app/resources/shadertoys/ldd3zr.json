{"Shader":{"ver":"0.1","info":{"id":"ldd3zr","date":"1447877269","viewed":373,"name":"one cube challenge - v1  (279)","username":"FabriceNeyret2","description":"challenge: code golf (here) or propose alternate algorithm (with close result) separately (then, copy this rule and  accept code-golfing).   The winner is the smaller :-)    ( but must adapt to window resolution )","likes":5,"published":3,"flags":0,"tags":["cube","2tweets","short","codegolf"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"\/\/ 279 by coyote\nvoid mainImage( out vec4 f, vec2 w ) {\n    f -= f;\n    vec4 p = vec4(w,0,0)\/iResolution.y - .5, d, t, M, m;\n    p.x -= .4; \/\/ init ray\n    d = p;     \/\/ ray dir = ray0-vec3(0)\n    p.z -= 4.; \/\/ cam pos\n   \n    for (int i=0; i<99; i++)\n        t = p, \/\/ local frame\n        t.xz *= mat2( w = sin(iDate.w+vec2(1.6,0)), -w.y,w.x ), \/\/ rotate\n    \n        m = min(M = max( t = abs(t), t.yzxw), M.yzxw), \/\/ dist to cube lines\n        \/\/f.w = max( max(t.x,M.y)-1., .99-min(m.x,m.y) ),\n        f.w = max( max(t.x,M.y)-1.2, 1.15-min(m.x,m.y) ),\n\n        f.w < .01 ? f++   \/\/ hit\n          : p -= d*f.w;   \/\/ march ray\n}\n\/**\/\n\n\n\n\/* \/\/ 297\n\n\/\/ using the base ray-marcher of Trisomie21: https:\/\/www.shadertoy.com\/view\/4tfGRB#\n\nvoid mainImage( out vec4 f, vec2 w ) {\n    f -= f;  \n    vec4 p = vec4(w,0,1)\/iResolution.y-.5, d, t,M,m; p.x-=.4; \/\/ init ray \n    d = p;                                             \/\/ ray dir = ray0-vec3(0)\n    p.z -= 4.;                                         \/\/ cam pos\n    vec2 T = sin(iDate.w+vec2(1.6,0));\n   \n    for (float i=1.; i>0.; i-=.01)  \n    {\n        t = p;  \/\/ t = mod(p, 8.)-4.;                  \/\/ local frame\n        t.xz *= mat2( T, -T.y,T.x );                   \/\/ rotate\n    \n        m = min(M = max( t = abs(t), t.yzxw), M.yzxw); \/\/ dist to cube lines\n        float x = max( max(t.x,M.y)-1.2, 1.15-min(m.x,m.y) );\n        \n        if(x<.01)  f++;                                \/\/ hit\n        \/\/ if(x<.01) { f +=i*i; break; }\n\n        p -= d*x;   \/\/ march ray\n     }\n }\n\/**\/","name":"","description":"","type":"image"}]}}