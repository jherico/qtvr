{"Shader":{"ver":"0.1","info":{"id":"Mll3WB","date":"1424977863","viewed":886,"name":"Fake Volume Light","username":"eiffie","description":"Some really cheap volume light effect.","likes":19,"published":3,"flags":0,"tags":["fake","cheap","volumelight"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"\/\/Fake Volume Light by eiffie\n\/\/A one tap volume light effect\n\n#define rez iResolution\n#define tyme iGlobalTime\n\nfloat Torus(in vec3 z, vec2 r){return length(vec2(length(z.xy)-r.x,z.z))-r.y;}\nmat2 rm=mat2(cos(tyme),sin(tyme),-sin(tyme),cos(tyme));\nfloat DE(in vec3 p){\n\tp+=vec3(0.0,-2.0,rm[0]);\n\tfloat dS=length(p)-0.5;\n\tp+=vec3(-3.0,3.0,0.0);\n\tp.xz=p.xz*rm;\n\tp.xy=rm*p.xy;\n\tfloat dB=length(max(abs(p)-vec3(0.5),0.0));\n\tp+=vec3(3.0,0.0,3.0);\n\tfloat dT=Torus(p.yzx,vec2(1.0,0.1));\n\treturn min(dS,min(dB,dT));\n}\n\nvec4 scene(in vec3 ro, in vec3 rd, in vec2 fragCoord){\n\tvec3 col=vec3(0.0);\n\tvec3 LightPos=vec3(0.0);\n\tfloat rnd=fract(sin(fragCoord.x+cos(fragCoord.y))*4317.6219);\n\tfloat t=rnd,d;\n\tro+=rd*t;\n\tfor(int i=0;i<32;i++){\n\t\tt+=d=DE(ro);\n\t\tfloat l=length(LightPos-ro);\n\t\tfloat shad=clamp(2.0*(1.0+d)*DE(ro+d*(LightPos-ro)\/l)\/d,0.0,1.0);\n\t\tcol+=exp(-l*5.0)+vec3(0.02)*clamp(1.0-l*0.1,0.0,1.0)*sqrt(d)*pow(shad,20.0);\n\t\tif(d<0.0001)break;\n\t\tro+=rd*min(d,0.5);\n\t}\n\treturn vec4(col,t);\n}\nmat3 lookat(vec3 fw,vec3 up){\n\tfw=normalize(fw);vec3 rt=normalize(cross(fw,up));return mat3(rt,cross(rt,fw),fw);\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n\tfloat tim=tyme*0.6;\n\tvec3 ro=vec3(sin(tim)*2.0,sin(tim*0.7),cos(tim))*5.0;\n\tvec3 rd=lookat(-ro,vec3(0.0,1.0,0.0))*normalize(vec3((2.0*(fragCoord.xy)-rez.xy)\/rez.y,1.0));\n\tvec4 color=scene(ro,rd,fragCoord);\n\tfragColor = vec4(color.rgb,1.0);\n}\n","name":"","description":"","type":"image"}]}}