{"Shader":{"ver":"0.1","info":{"id":"4tSXWc","date":"1446767918","viewed":434,"name":"Regular nGon Function","username":"Aj_","description":"A function which generates ngons for a given apothem\/radius","likes":3,"published":3,"flags":0,"tags":["geometry"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"#define PIX2 6.28318530718\n#define NEARMULT(V, OF) floor( (PIX2+V)\/OF + .5 ) * OF\nconst float a = .10;\nconst float rad = .17;\n\nfloat nGonCA(vec2 c, vec2 p, float n, float a) { \/\/a = apothem\n\n\t\n\tfloat divAng = PIX2\/n;\n\tvec2 pc = p-c;\n\tfloat lpc = length(pc);\n\tfloat ang = (atan(pc.y,pc.x)) ; \t\n\tfloat nearAng = NEARMULT(ang, divAng);\t\n\tvec2 locRVec = a*(vec2(cos(nearAng), sin(nearAng)));\n\tvec2 nLRV = normalize(locRVec);\n\tfloat ct = dot(normalize(pc), nLRV);\n\treturn a-ct*lpc;\n\t\n}\n\nfloat nGonCR(vec2 c, vec2 p, float n, float rad) { \n\t\n\tfloat s = rad*2.*sin(3.14159265359\/n);\n\tfloat a = sqrt(rad * rad - (s*s\/4.));\t\t\n\treturn nGonCA(c, p, n, a);\n}\n\n#define circle(c,p,rad) rad - distance(p,c)\n#define goodmix(col1, col2) mix(col1*(1. - floor(col2.a)) +col2*col2.a, col2, col2.a );\n\n\n\nfloat line(vec2 p, vec2 c1, vec2 c2, float width) {\n\tvec2 dc = c2-c1;\n\tfloat lineLen = length(dc) - 2.*width;\n\tvec2 lineNorm = normalize(dc);\n\tc1+=lineNorm*width;\n\tfloat ang = atan(dc.y, dc.x);\n\tfloat dcl = distance(p, c1);\n\tfloat proj = dot(lineNorm, normalize(p-c1));\n\t\/\/float radM = sign(min(proj,dot(-dc, p-c2)));\n\tvec2 np = (c1+clamp(dcl*proj, 0., lineLen)*lineNorm);\n\treturn circle(np, p, width);;\/\/*radM);\n\t\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\t\n    vec2 p = ( fragCoord.xy \/ iResolution.x -.5*iResolution.xy\/iResolution.x).xy;\t\n\tvec4 back = vec4(.7, .0, 0.0, 0.) * ((.9 - length(p)));\n\tvec3 colP = vec3(0.1, 0.5 ,.6);\n\tvec3 colC = vec3(.2, .2, .5);\n\tvec4 colL, colR, colCL ;\n\tfloat ngCR = nGonCR(vec2(-.2,0.),p, \n\t\t\t3.+floor(mod((iGlobalTime), 10.))\t\t\t\n\t\t\t, rad);\n\t\n\tfloat ngCA = nGonCA(vec2(.2,0.),p, \n\t\t\t3.+floor(mod((iGlobalTime), 10.))\t\t\t\n\t\t\t, a);\n\tfloat c = circle(vec2(-.2,0.),p, rad);\n\tfloat l = line(p, vec2(.2, 0.), vec2(a+.2, 0.), .005);\n\t\n\tcolCL = vec4(colC, smoothstep(0., .004, c));\n\tcolL = vec4(colP,  smoothstep(0., .004, ngCR));\n\tcolR = vec4(colP, smoothstep(0., .004, ngCA));\n\tvec4 colLine = vec4(colC, smoothstep(0., .004, l));\n\t\n\tback = mix(back, colCL, colCL.a);\/\/\n\tback = goodmix(back, colCL);\n\tback = goodmix(back, colL);\n\tback = goodmix(back, colR);\n\tback = goodmix(back, colLine);\n\t\n\t\n\tfragColor = back;\n}","name":"","description":"","type":"image"}]}}