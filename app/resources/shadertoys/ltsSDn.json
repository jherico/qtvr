{"Shader":{"ver":"0.1","info":{"id":"ltsSDn","date":"1435954605","viewed":738,"name":"crowded pillars 4","username":"FabriceNeyret2","description":"variant of https:\/\/www.shadertoy.com\/view\/XtfSDn","likes":4,"published":3,"flags":0,"tags":["3d","raymarching","short"],"hasliked":0},"renderpass":[{"inputs":[{"id":26,"src":"\/presets\/cube04_0.png","ctype":"cubemap","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}}],"outputs":[{"channel":"0"}],"code":"\/\/ using the base ray-marcher of Trisomie21: https:\/\/www.shadertoy.com\/view\/4tfGRB#\n\n#define T iGlobalTime\n#define r(v,t) { float a = (t)*T, c=cos(a),s=sin(a); v*=mat2(c,s,-s,c); }\n#define smin(a,b) (1.\/(1.\/(a)+1.\/(b)))\n\nvoid mainImage( out vec4 f, vec2 w ) {\n    vec4 p = vec4(w,0,1)\/iResolution.yyxy-.5, d,c; p.x-=.4; \/\/ init ray \n    r(p.xz,.13); r(p.yz,.2); r(p.xy,.1);   \/\/ camera rotations\n    d = p;                                 \/\/ ray dir = ray0-vec3(0)\n    p.z += 50. *cos(.1*T);\n    \/\/f = vec4(0);\n    \n    for (float i=1.; i>0.; i-=.01)  {\n        \n        float R=8.+4.*cos(.05*T), x,v;\n        vec4 u = floor(p\/R), t = mod(p, R)-R\/2.; \/\/, ta=abs(t); \/\/ objects id + local frame\n        c = textureCube(iChannel0, abs(t).zxy-3.);  \/\/ c for color, c.x for displacement\n  \n        \/\/ r(t.xy,u.x); r(t.xz,u.y); r(t.yz,u.z);\n        \/\/ t -= 2.*u;  \n        \n        x = smin(length(t.xy),smin(length(t.yz),length(t.xz))) -.7 +c.x;   \n        \/\/ v = c.x*.4;\n        \/\/ x = max(x, -ta.x+.4-v);  x = max(x, -ta.y+.4-v);  x = max(x, -ta.z+.4-v);\n        \n        if(x<.01) \/\/ hit !\n            { f = 2.*i*c; break;  }  \/\/ color texture + black fog \n        \n        p -= d*x;           \/\/ march ray\n     }\n}\n","name":"","description":"","type":"image"}]}}