{"Shader":{"ver":"0.1","info":{"id":"ltsGWn","date":"1421118932","viewed":1737,"name":"Nyan Cat in Mode 7","username":"poljere","description":"The Nyan Cat goes for an infinite walk around this \"mode 7\"-based world. Mode 7 was used in the SNES days <a href=\"http:\/\/en.wikipedia.org\/wiki\/Mode_7\" class=\"regular\" target=\"_blank\">http:\/\/en.wikipedia.org\/wiki\/Mode_7<\/a>. If anyone got the chance to work with it, I'd love to learn more about it!","likes":5,"published":3,"flags":0,"tags":["nyan","nyancat","snes","mode7"],"hasliked":0},"renderpass":[{"inputs":[{"id":1,"src":"\/presets\/tex00.jpg","ctype":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}},{"id":14,"src":"\/presets\/tex14.png","ctype":"texture","channel":1,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}}],"outputs":[{"channel":"0"}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 q = (fragCoord.xy \/ iResolution.xy);\n    vec2 uv = q - vec2(0.5);\n    \n    \/\/ Create a 3D point\n    float h = 0.25;\n\tvec3 p = vec3(uv.x, uv.y - h - 1.0, uv.y - h);\n    \n    \/\/ Projecting back to 2D space\n    vec2 uvm7 = p.xy \/ p.z;\n    \n    \/\/ Texture scaling if you need\n    float scale = 0.4;\n    uvm7 *= scale;\n    \n    \/\/ Rotations if needed\n    float a = iGlobalTime * 0.3;\n    mat2 rotation = mat2(cos(a), - sin(a), sin(a), cos(a));\n    uvm7 *= rotation;\n    \n    \/\/ Read background texture\n    vec3 col = texture2D(iChannel0, uvm7).xyz;    \n    \n    \/\/ Add the nyan cat sprite : https:\/\/www.shadertoy.com\/view\/lsX3Rr\n    vec2 uvNyan = (q  - vec2(0.25, 0.15)) \/ (vec2(0.7,0.5) - vec2(0.5, 0.15));\n    uvNyan = clamp(uvNyan, 0.0, 1.0);\n    float ofx = floor( mod( iGlobalTime*15.0, 6.0 ) );\n\tfloat ww = 40.0\/256.0;\n    uvNyan = vec2(clamp( uvNyan.x*ww + ofx*ww, 0.0, 1.0 ), 1.0-uvNyan.y);\n    vec4 colNyan = texture2D( iChannel1, uvNyan );\n    \n    \/\/ Generate the nyan cat shadow\n    vec2 uvShadow = q - vec2(0.35, 0.23);\n    float an = atan(uvShadow.y, uvShadow.x);\n    float r  = length(uvShadow);\n    float sh = smoothstep(0.0, 0.11, r);\n    \n    \/\/ Combine the nyan cat, the shadow and the background\n    col = mix(sh * col, colNyan.xyz, colNyan.a);\n    \n    \/\/ Darkness based on the horizon\n    col *= abs(uv.y - h - 0.35);\n    \n    \/\/ Output the color\n\tfragColor = vec4(col,1.0);\n}","name":"","description":"","type":"image"}]}}