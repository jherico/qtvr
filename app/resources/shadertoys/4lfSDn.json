{"Shader":{"ver":"0.1","info":{"id":"4lfSDn","date":"1435667788","viewed":906,"name":"crowded pillars 3","username":"FabriceNeyret2","description":"a variant of https:\/\/www.shadertoy.com\/view\/XtfSDn<br\/>Be sure to wait long enough ;-)","likes":25,"published":3,"flags":0,"tags":["3d","raymarching","short"],"hasliked":0},"renderpass":[{"inputs":[{"id":23,"src":"\/presets\/cube01_0.png","ctype":"cubemap","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}}],"outputs":[{"channel":"0"}],"code":"\/\/ using the base ray-marcher of Trisomie21: https:\/\/www.shadertoy.com\/view\/4tfGRB#\n\n#define T iGlobalTime\n#define r(v,t) { float a = (t)*T, c=cos(a),s=sin(a); v*=mat2(c,s,-s,c); }\n#define SQRT3_2  1.26\n#define SQRT2_3  1.732\n#define smin(a,b) (1.\/(1.\/(a)+1.\/(b)))\n\nvoid mainImage( out vec4 f, vec2 w ) {\n    vec4 p = vec4(w,0,1)\/iResolution.yyxy-.5, d,c; p.x-=.4; \/\/ init ray \n    r(p.xz,.13); r(p.yz,.2); r(p.xy,.1);   \/\/ camera rotations\n    d = p;                                 \/\/ ray dir = ray0-vec3(0)\n    p.z += 5. *T;\n    vec2 mouse = iMouse.xy\/iResolution.xy;\n    float closest = 999.0;\n    f = vec4(0);\n    \n    for (float i=1.; i>0.; i-=.01)  {\n        \n        vec4 u = floor(p\/8.), t = mod(p, 8.)-4., ta; \/\/ objects id + local frame\n        \/\/ vec4 u=floor(p\/18.+3.5), t = p, ta,v;\n        \/\/ r(t.xy,u.x); r(t.xz,u.y); r(t.yz,1.);    \/\/ objects rotations\n        u = sin(78.*(u+u.yzxw));                    \/\/ randomize ids\n        \/\/ t -= u;                                  \/\/ jitter positions\n        c = p\/p*1.2; \/\/ *vec4(1,0,0,0);\n \n        float x1,x2,x3,x=1e9, t4 = clamp(cos(T\/4.),0.,1.), t8 = clamp(cos(T\/8.),0.,1.);\n        \/\/ r(t.xy,u.x); r(t.xz,u.y); r(t.yz,u.z);\n        \/\/ t -= 2.*u;  \n        ta = abs(t);\n        x2 = smin(length(t.xy),smin(length(t.yz),length(t.xz))) -.7;   \n        \/\/ ta = abs(mod(p, .25)); x1 = min(ta.x,min(ta.y,ta.z))-.05; x = sqrt(x1*x1+x*x)-.0; \/\/ max(-x1,x);\n        \/\/ ta = abs(mod(p, 1.)); x1 = min(ta.x,min(ta.y,ta.z))-.4; x = sqrt(x1*x1+x2*x2)-.0; \/\/ x = max(-x1,x);\n        ta = abs(mod(p, 1.)-.2); x1 = min(ta.x,min(ta.y,ta.z)); x1 = sqrt(x1*x1+x2*x2)-.0; \/\/ x = max(-x1,x);\n        ta = abs(mod(p, 1.)+.2); x3 = min(ta.x,min(ta.y,ta.z)); x3 = sqrt(x3*x3+x2*x2)-.0; \/\/ x = max(-x1,x);\n     \tx = min(x1,x3);\n        x3 = min(length(t.xy),min(length(t.yz),length(t.xz))) -.0; \/\/x = min(x,x3);\n        f += .7*vec4(1,1,0,0) * exp(-10.*x3)*clamp(dot(.3+.7*sin(3.*(p+8.*T+u)),vec4(1,1,1,0)),0.,1.)*t8*t4;\n        \/\/ x3 = min(x3, closest);\n        \/\/ if (x==x3) c=vec4(1,1,0,0);\n\n        if(x2<.01) f += .01*vec4(1.5,.3,.3,0)*t4; \/\/*textureCube(iChannel0, t.xyz-3.)*2.;\n            \n        if(x<.01) \/\/ hit !\n            { f += i*c*1.; break;  }  \/\/ color texture + black fog \n        \n        p -= d*x;           \/\/ march ray\n     }\n    \/\/f += vec4(1,1,0,0) * exp(-closest); \/\/ *(.5+.5*cos(T\/2.)); \/\/ thanks kuvkar ! \n}\n","name":"","description":"","type":"image"}]}}