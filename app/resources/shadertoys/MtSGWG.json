{"Shader":{"ver":"0.1","info":{"id":"MtSGWG","date":"1431798043","viewed":412,"name":"Skateboard camo version","username":"yasuo","description":"it's just my drawing staff that I really like to draw, and experiment.","likes":2,"published":3,"flags":0,"tags":["3d","skateboard"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"\t\t#define NEAR 0.1\n\t\t#define FAR 100.\n\t\t#define ITER 128\n\t\t#define HALF_PI 1.5707963267948966\n\t\tconst float PI = 3.14159265359;\n\t\tconst float DEG_TO_RAD = PI \/ 180.0;\n\t\tfloat gt;\n\t\tfloat gtime;\n\n\t\tmat4 matRotateX(float rad)\n\t\t{\n\t\t\treturn mat4(1,       0,        0,0,\n\t\t\t\t\t\t0,cos(rad),-sin(rad),0,\n\t\t\t\t\t\t0,sin(rad), cos(rad),0,\n\t\t\t\t\t\t0,       0,        0,1);\n\t\t}\n\n\t\tmat4 matRotateY(float rad)\n\t\t{\n\t\t\treturn mat4( cos(rad),0,-sin(rad),0,\n\t\t\t\t\t\t 0,       1,        0,0,\n\t\t\t\t\t\t sin(rad),0, cos(rad),0,\n\t\t\t\t\t\t 0,       0,        0,1);\n\t\t}\n\n\t\tmat4 matRotateZ(float rad)\n\t\t{\n\t\t\treturn mat4(cos(rad),-sin(rad),0,0,\n\t\t\t\t\t\tsin(rad), cos(rad),0,0,\n\t\t\t\t\t\t       0,        0,1,0,\n\t\t\t\t\t\t\t   0,        0,0,1);\n\t\t}\n\n\t\tvec4 combine(vec4 val1, vec4 val2 )\n\t\t{\n\t\t\tif ( val1.w < val2.w ) return val1;\n\t\t\treturn val2;\n\t\t}\n\t\t\n\t\tvec2 rot(vec2 p, float a) {\n\t\t\treturn vec2(\n\t\t\t\tcos(a) * p.x - sin(a) * p.y,\n\t\t\t\tsin(a) * p.x + cos(a) * p.y);\n\t\t}\n\n\t\t\/\/ http:\/\/www.iquilezles.org\/www\/articles\/distfunctions\/distfunctions.htm\n\t\tfloat sdCappedCylinder( vec3 p, vec2 h )\n\t\t{\n\t\t  vec2 d = abs(vec2(length(p.xz),p.y)) - h;\n\t\t  return min(max(d.x,d.y),0.0) + length(max(d,0.0));\n\t\t}\n\n\t\t\/\/ http:\/\/www.iquilezles.org\/www\/articles\/distfunctions\/distfunctions.htm\n\t\tfloat sdCone( vec3 p, float r, float h )\n\t\t{\n\t\t\tvec2 c = normalize( vec2( h, r ) );\n\t\t    float q = length(p.xy);\n\t\t    return max( dot(c,vec2(q,p.z)), -(p.z + h) );\n\t\t}\n\n\t\t\/\/ http:\/\/www.iquilezles.org\/www\/articles\/distfunctions\/distfunctions.htm\n\t\tfloat udRoundBox( vec3 p, vec3 b, float r )\n\t\t{\n\t\t  return length(max(abs(p)-b,sin(r*0.1)))-r;\n\t\t}\n\n\t\tfloat rand( vec2 p )\n\t\t{\n\t\t\treturn fract(sin(dot(p.xy ,vec2(12.9898,78.233))) * 43758.5453);\n\t\t}\n\n\t\tfloat noise(vec2 _v, vec2 _freq)\n\t\t{\n\t\t\tfloat fl1 = rand(floor(_v * _freq));\n\t\t\tfloat fl2 = rand(floor(_v * _freq) + vec2(1.0, 0.0));\n\t\t\tfloat fl3 = rand(floor(_v * _freq) + vec2(0.0, 1.0));\n\t\t\tfloat fl4 = rand(floor(_v * _freq) + vec2(1.0, 1.0));\n\t\t\tvec2 fr = fract(_v * _freq);\n\n\t\t\tfloat r1 = mix(fl1, fl2, fr.x);\n\t\t\tfloat r2 = mix(fl3, fl4, fr.x);\n\t\t\treturn mix(r1, r2, fr.y);\n\t\t}\n\n\t\tfloat perlin_noise(vec2 _pos, float _freq_start, float _amp_start, float _amp_ratio)\n\t\t{\n\t\t\tfloat freq = _freq_start;\n\t\t\tfloat amp = _amp_start;\n\t\t\tfloat pn = noise(_pos, vec2(freq, freq)) * amp;\n\t\t\tfor(int i=0; i<4; i++)\n\t\t\t{\n\t\t\t\tfreq *= 2.0;\n\t\t\t\tamp *= _amp_ratio;\n\t\t\t\tpn += (noise(_pos, vec2(freq, freq)) * 2.0 - 1.0) * amp;\n\t\t\t}\n\t\t\treturn pn;\n\t\t}\n\n\t\tvec3 texmain(vec2 position) {\n\t\t\tfloat noise = perlin_noise( position + vec2(10, 10), 3., .3, .3 );\n\t\t\t\n\t\t\tfloat t = iGlobalTime*2.0;\n\t\t\tfor(int i=1;i<3;i++)\n\t\t\t{\n\t\t\t\tvec2 newp=position;\n\t\t\t\tnewp.x+=3.3\/float(i)*cos(float(i)*position.y+t*0.3+0.3*float(i))+noise;\n\t\t\t\tnewp.y+=2.3\/float(i)*sin(float(i)*position.x+t*0.5+0.3*float(i))-noise;\n\t\t\t\tposition=newp;\n\t\t\t}\n\t\t\tvec3 col=vec3(0.35*sin(1.1*position.x),0.5*sin(2.0*position.y),0.1*sin(position.x));\n\t\n\t\t\treturn col;\n\t\t}\n\n\t\tvec4 map( vec3 pos, mat4 m)\n\t\t{\n\t\t\tpos = vec3((pos.x),(pos.y),(pos.z));\n\t\t\tvec4 q = vec4(pos+vec3(0,0,-70.0),1.0)*m;\n\n\t\t\tvec3 bcl = texmain(q.xz);\n\t\t\t\/\/vec3 bcl = vec3(1.0,1.0,0);\n\t\t\tvec4 newQ = vec4(q.xyz+ vec3( 0, -4.0, -18.0 ),1.0)*matRotateX(12.0 * DEG_TO_RAD);\n\t\t\tvec4 val = vec4(bcl,udRoundBox(newQ.xyz,vec3(7.0,0.1,3.0),0.5));\n\n\t\t\tvec4 newQ0 = vec4(q.xyz+ vec3( 0, -3.5, 2 ),1.0);\n\t\t\tvec4 val0 = vec4(bcl,udRoundBox(newQ0.xyz,vec3(7.0,0.1,18.0),0.5));\n\n\t\t\tvec4 newQ1 = vec4(q.xyz+ vec3( 6, 0, 15 ),1.0)*matRotateZ(-90.0 * DEG_TO_RAD);\n\t\t\tvec4 val1 = vec4(1.0,0,0,sdCappedCylinder(newQ1.xyz,vec2(2.0,2.0)));\n\n\t\t\tvec4 newQ2 = vec4(q.xyz+ vec3( -6, 0, 15 ),1.0)*matRotateZ(-90.0 * DEG_TO_RAD);\n\t\t\tvec4 val2 = vec4(1.0,0,0,sdCappedCylinder(newQ2.xyz,vec2(2.0,2.0)));\n\n\t\t\tvec4 newQ3 = vec4(q.xyz+ vec3( 0, 0, 15 ),1.0)*matRotateZ(-90.0 * DEG_TO_RAD);\n\t\t\tvec4 val3 = vec4(0.7,0.7,0.7,sdCappedCylinder(newQ3.xyz,vec2(1.0,5.0)));\n\n\t\t\tvec4 newQ4 = vec4(q.xyz+ vec3( -0, 0, 15 ),1.0)*matRotateX(-90.0 * DEG_TO_RAD);\n\t\t\tvec4 val4 = vec4(0.3,0.3,0.3,sdCone(newQ4.xyz,2.0,4.0));\n\n\n\t\t\tvec4 newQ5 = vec4(q.xyz+ vec3( 6, 0, -15 ),1.0)*matRotateZ(-90.0 * DEG_TO_RAD);\n\t\t\tvec4 val5 = vec4(1.0,0,0,sdCappedCylinder(newQ5.xyz,vec2(2.0,2.0)));\n\n\t\t\tvec4 newQ6 = vec4(q.xyz+ vec3( -6, 0, -15 ),1.0)*matRotateZ(-90.0 * DEG_TO_RAD);\n\t\t\tvec4 val6 = vec4(1.0,0,0,sdCappedCylinder(newQ6.xyz,vec2(2.0,2.0)));\n\n\t\t\tvec4 newQ7 = vec4(q.xyz+ vec3( 0, 0, -15 ),1.0)*matRotateZ(-90.0 * DEG_TO_RAD);\n\t\t\tvec4 val7 = vec4(0.7,0.7,0.7,sdCappedCylinder(newQ7.xyz,vec2(1.0,5.0)));\n\n\t\t\tvec4 newQ8 = vec4(q.xyz+ vec3( 0, 0, -15 ),1.0)*matRotateX(-90.0 * DEG_TO_RAD);\n\t\t\tvec4 val8 = vec4(0.3,0.3,0.3,sdCone(newQ8.xyz,2.0,4.0));\n\n\t\t\tvec4 val9 = combine ( val, val0 );\n\t\t\tvec4 val10 = combine ( val1, val2 );\n\t\t\tvec4 val11 = combine ( val3, val4 );\n\t\t\tvec4 val12 = combine ( val5, val6 );\n\t\t\tvec4 val13 = combine ( val7, val8 );\n\t\t\tvec4 val14 = combine ( val9, val10 );\n\t\t\tvec4 val15 = combine ( val11, val12 );\n\t\t\tvec4 val16 = combine ( val13, val14 );\n\t\t\treturn combine ( val15, val16 );\n\t\t}\n\n\t\tvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n\t\t\tgt = iGlobalTime*0.5;\n\n\t\t\tvec2 position = ( fragCoord.xy \/ iResolution.xy );\n\t\t\tposition -= .5;\n\t\t\tvec3 dir = vec3( position, 1.0 );\n\t\t\t\n         \tfloat aspect = iResolution.x \/ iResolution.y;\n         \tdir = normalize(vec3(position * vec2(aspect, 1.0), 1.0));\n\t\t \tdir.yz = rot(dir.yz, -0.1);\n\n\t\t \tvec3 pos = vec3(0.0, 3.0, 15.0);\n\t\n\t\t\tfloat t = floor(gt);\n\t\t    float f = fract(gt);\n\t\t    t += sin(-13.0 * (f + 1.0) * HALF_PI) * pow(2.0, -10.0 * f) + 1.0;\n\t\t    gtime = t;\n\n\t\t\tmat4 m = matRotateY(iGlobalTime)*matRotateX(gtime)*matRotateZ(gtime);\n\n\t\t\tvec4 result;\n\t\t\tfor (int i =0; i < ITER; i++)\n\t\t\t{\n\t\t\t\tresult = map(pos, m);\n\t\t\t\tif (result.w < NEAR || result.w > FAR) break;\n\t\t\t\tpos += result.w * dir;\n\t\t\t}\n\n\t\t\tvec3 col = map(pos, m).xyz;\n\t\t\tif ( pos.z> 100. )\n\t\t\t{\n\t\t\t\tfloat temp = length(vec2(position.xy))+0.9;\n\t\t\t\tcol = vec3(.5,.5,.5)\/vec3(temp);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvec3 lightPos = vec3(20.0, 20.0, 20.0 );\n\t\t\t\tvec3 light2Pos = normalize( lightPos - pos);\n\t\t\t\tvec3 eps = vec3( .1, .01, .0 );\n\t\t\t\tvec3 n = vec3( result.w - map( pos - eps.xyy, m ).w,\n\t\t\t\t\t       result.w - map( pos - eps.yxy, m ).w,\n\t\t\t\t\t       result.w - map( pos - eps.yyx, m ).w );\n\t\t\t\tn = normalize(n);\n\t\t\t\t\t\t\n\t\t\t\tfloat lambert = max(.0, dot( n, light2Pos));\n\t\t\t\tcol *= vec3(lambert);\n\t\t\t\t\n\t\t\t\t\/\/ specular : \n\t\t\t\tvec3 h = normalize( -dir + light2Pos);\n\t\t\t\tfloat spec = max( 0., dot( n, h ) );\n\t\t\t\tcol += vec3(pow( spec, 16.)) ;\n\t\t\t}\n\n\t\t\tfragColor = vec4( col, 1.0);\n\t\t}","name":"","description":"","type":"image"}]}}