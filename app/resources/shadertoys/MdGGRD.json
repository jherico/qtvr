{"Shader":{"ver":"0.1","info":{"id":"MdGGRD","date":"1453437162","viewed":123,"name":"Seashells reaction-diffusion","username":"FabriceNeyret2","description":"trying to reproduce Fig.11->15 of Sig'92 paper http:\/\/algorithmicbotany.org\/papers\/shells.sig92.pdf<br\/>NB: a lot of details were missing in the paper   (init values, dx,dt, ranges,  values-to-display... )","likes":4,"published":3,"flags":32,"tags":["reactiondiffusion"],"hasliked":0},"renderpass":[{"inputs":[{"id":257,"src":"\/presets\/previz\/buffer00.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"}}],"outputs":[{"channel":"0"}],"code":"void mainImage( out vec4 O, vec2 U ) { O = texture2D(iChannel0,U\/iResolution.xy).r*vec4(1,.3,.1,0); }","name":"","description":"","type":"image"},{"inputs":[{"id":257,"src":"\/presets\/previz\/buffer00.png","ctype":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"}}],"outputs":[{"channel":"0"}],"code":"\/\/ trying to reproduce Fig.11->15 of Sig'92 paper http:\/\/algorithmicbotany.org\/papers\/shells.sig92.pdf\n\/\/ Finally got the missing parameters from dr P himself ;-)\n\n#define FIG 14 \/\/ 11,12,13,14,15\n\n#if FIG==11   \/\/ --- Fig 11\n  float r= 0.01, r0= 1e-3,  u= 1e-2, Da= 2e-3, s= .015,  v=0.,  Dh=0.4,   k=0., ap=0.03, \n\n#elif FIG==12 \/\/ --- Fig 12 Amoria\n#define SIN true\n  float r= 0.1,  r0= 5e-3,  u= 0.1,  Da= 4e-3, s=.012,   v=0.,  Dh=0.,    k=1., ap=0., \n\n#elif FIG==13  \/\/ --- Fig 13 Volutoconus\n#define SIN true\n  float r= 0.1,  r0= 2.5e-3, u= 0.1, Da= 1e-2, s=.11,   v=2e-3,  Dh=0.05, k=0.5, ap=0.03,\n\n#elif FIG==14 \/\/ --- Fig 14 Oliva\n  float r= 0.1,  r0= 1e-4,   u= 0.1, Da= 0.015, s= 2e-4, v =.014, Dh=0., k=0.25, ap=0.03,\n       rr= 0.1,   n= .1,   h0= 0.1, \n\n#elif FIG==15 \/\/ --- Fig 15 Marmoreud. model + param described in another paper. good luck to find it \n  float  r=.1,    r0= 0.,   u=.1,   Da = .01, s=3.8e-2, v = 5e-3, Dh = 0., k=3., ap=0.05,\n        rr= 0.05,  n= .1,   h0= 0.1, \n#endif\n      \n    dx=1., dt=10.;  \/\/ values not in the paper (it impacts Da,Dh)\n    \n#define tex(di) texture2D(iChannel0,(U+vec2(di,-1))\/iResolution.xy) \/\/ access previous line\n#define rand( seed ) fract(1e4*sin(seed*7.451))\n#define rand4(seed4) fract(1e4*sin(seed4*vec4(17.456,-34.4,23.17,-127.9)))\n\nvoid mainImage( out vec4 O, vec2 U )\n{\n  \/\/r *= 1. + 0.025*(2.*rand(U.x)-1.);            \/\/ 2.5% fluctuation on rho\n    r *= 1. + 0.025*(2.*step(.5,rand(U.x))-1.);   \/\/ 2.5% binary fluctuation on rho\n#ifdef SIN\n    s = .02+s*(.5+.5*sin(4.*6.28*U.x\/iResolution.x)); \/\/ Fig 12\/13 : periodic fluctuations of sigma\n#endif\n#if FIG==11\n\tdt = 1.3;\n#endif\n    \n    if (int(U.y)==0) { \/\/ initialize first line\n        \/\/ O = .45*rand4(U.xyxy); \/\/ init value of a,h,c not in the paper\n        O.x = step(rand(U.x),ap);\n        O.z = 1e-2; O.y=0.;\n        return;\n      }\n    \n    \n    O = tex(0); \/\/ (a,h,c) from previous line \n    \n    vec4 LO =  ( tex(-1) + tex(1) -2.*O ) \/ (dx*dx); \/\/ laplacian(a,h,c)\n    float a = O.x, h = O.y, c = O.z,\n        \n          d =    a*a\/(1.+k*a*a),\n         dd =    r*h*( d + r0 ),\n#if FIG < 14 \/\/ activator-substract equation (s represented by h)\n         da =     dd - u *a  + Da*LO.x,\n         dh = s - dd - v *h  + Dh*LO.y,\n         dc = 0.;\n#elif FIG==14  \/\/ activator-inhibitor-substract equation\n         da = r\/(h+h0)*( d + r0 ) - u *a  + Da*LO.x,\n         dh = s    + r * d        -v\/c*h  + Dh*LO.y,\n#else  \/\/ coupled systems\n         da =      dd - u *a + Da*LO.x,\n         dh = s\/c -dd - v *h + Dh*LO.y,\n#endif\n#if FIG >= 14\n         dc = 0.;\n    for (float i=0.5; i<1920.; i++) { \/\/ average of a\n        if (i>=iResolution.x) break;\n        dc += tex(i-U.x).x;\n    }\n    \/\/ n=1.;\n    dc = rr*dc\/iResolution.x - n*c;\n#endif\n    \n    O += vec4(da,dh,dc,0) * dt; \n    O  = max(O,vec4(1e-5)); \/\/ what is supposed to be the range of a,h,c ?\n}","name":"","description":"","type":"buffer"}]}}