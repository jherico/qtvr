{"Shader":{"ver":"0.1","info":{"id":"XtXGRj","date":"1423172100","viewed":777,"name":"Heart in Swimwear","username":"eiffie","description":"Embarrassingly my heart still thinks it can fit into summer clothes after gaining winter weight.","likes":4,"published":3,"flags":0,"tags":["heartsurface"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"channel":"0"}],"code":"\/\/heart in swimwear by eiffie\n\/\/coloring idea from iq's https:\/\/www.shadertoy.com\/view\/XsfGRn\n\/\/gradient idea from miloyip's https:\/\/www.shadertoy.com\/view\/XtXGR8\n\n#define time iGlobalTime\n#define size iResolution\n\nvec3 mcol;\nbool bColoring=false;\n#define pi 3.14159\nfloat DE(in vec3 p){\n\tfloat h=p.x*p.x+p.y*p.y+2.0*p.z*p.z-1.0,pyyy=p.y*p.y*p.y;\n\tfloat v=h*h*h-(p.x*p.x-0.1*p.z*p.z)*pyyy;\/\/the messed up bit\n\tvec3 g=vec3(6.0*p.x*h*h-2.0*p.x*pyyy,\n\t\t6.0*p.y*h*h-3.0*p.x*p.x*p.y*p.y-0.3*p.z*p.z*p.y*p.y,\n\t\t12.0*p.z*h*h-0.2*p.z*pyyy);\n\tif(bColoring){\n\t\th-=(p.x*p.x-0.1*p.z*p.z)*pyyy;\n\t\tif(h<0.0)mcol=vec3(1.0,0.15,0.2);else mcol=vec3(1.0,0.0,1.0);\n\t\tmcol=mix(vec3(0.5,0.0,0.0),mcol,clamp(abs(h+0.04)*20.0,0.0,1.0));\n\t}\n\treturn v\/max(0.2,length(g));\n}\n\nfloat rnd(vec2 c){return fract(sin(dot(vec2(1.317,19.753),c))*413.7972);}\nfloat rndStart(vec2 fragCoord){\n\treturn 0.5+0.5*rnd(fragCoord.xy+vec2(time*217.0));\n}\nvec3 Sky(vec3 rd){\/\/what sky??\n\treturn vec3(0.7,0.8,1.0)*(0.5+0.5*rd.y);\n}\nvec3 L;\nvec3 Color(vec3 ro, vec3 rd, float t, float px, vec3 col){\n\tro+=rd*t;\n\tbColoring=true;float d=DE(ro);bColoring=false;\n\tvec2 e=vec2(px*t,0.0);\n\tvec3 dn=vec3(DE(ro-e.xyy),DE(ro-e.yxy),DE(ro-e.yyx));\n\tvec3 dp=vec3(DE(ro+e.xyy),DE(ro+e.yxy),DE(ro+e.yyx));\n\tvec3 N=(dp-dn)\/(length(dp-vec3(d))+length(vec3(d)-dn));\n\tvec3 R=reflect(rd,N);\n\tvec3 lc=vec3(1.0,0.9,0.8),sc=mcol,rc=Sky(R);\n\tif(sc.b>0.5){\n\t\tvec3 p=ro;p.y-=0.44;\n\t\tfloat a = atan(p.x,p.y)\/3.141593;\n    \t\tfloat r = length(p);\n    \t\tfloat h = abs(a);\n    \t\th = (13.0*h - 22.0*h*h + 10.0*h*h*h)\/(6.0-5.0*h);\n\t\tsc.g=0.25+0.25*sin((h-r)*100.0);\n\t}\n\tfloat h=0.2*dot(N,R);\n\tsc*=vec3(0.8+h,1.0,0.8-h);\n\tfloat sh=1.0;\/\/clamp(shadao(ro,L,px*t)+0.2,0.0,1.0);\n\tsh=sh*(0.5+0.5*dot(N,L)+abs(rd.y)*0.2);\n\tvec3 scol=sh*lc*(sc+rc*pow(max(0.0,dot(R,L)),4.0));\n\tcol=mix(scol,col,clamp(d\/(px*t),0.0,1.0));\n\treturn col;\n}\nmat3 lookat(vec3 fw){\n\tfw=normalize(fw);vec3 rt=normalize(cross(fw,vec3(0.0,1.0,0.0)));return mat3(rt,cross(rt,fw),fw);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n\tfloat px=1.6\/size.y;\n\tL=normalize(vec3(0.4,0.8,-0.6));\n\tfloat tim=time*0.5;\n\t\n\tvec3 ro=vec3(cos(tim),sin(tim*0.4)*0.25,sin(tim))*5.0;\n\tvec3 rd=lookat(vec3(-0.1)-ro)*normalize(vec3((2.0*fragCoord.xy-size.xy)\/size.y,3.0));\n\t\n\tfloat t=DE(ro)*rndStart(fragCoord),d=0.0,dm=10.0,tm=0.0;\n\tvec3 col=Sky(rd);\n\tfor(int i=0;i<64;i++){\n\t\tt+=d;\n\t\td=DE(ro+rd*t);\n\t\tif(d<dm){dm=d;tm=t;}\n\t\tif(t>10.0 || d<0.0001)break;\n\t}\n\tcol=Color(ro,rd,tm,px,col);\n\tfragColor = vec4(1.5*col,1.0);\n}\n","name":"","description":"","type":"image"}]}}